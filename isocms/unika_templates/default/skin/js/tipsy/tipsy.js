(function(a){a.fn.tipsy=function(b){b=a.extend({},a.fn.tipsy.defaults,b);return this.each(function(){var c=a.fn.tipsy.elementOptions(this,b);a(this).hover(function(){a.data(this,"cancel.tipsy",true);var n=a.data(this,"active.tipsy");var o=(typeof c.gravity=="function")?c.gravity.call(this):c.gravity;if(!n){ctn='<div class="tipsy">';if(c.title!="title"){ctn+='<div class="tipsy-title">Help</div>'}ctn+='<div class="tipsy-inner"/>';ctn+='<div class="tipsy-arrow"><div class="arrow-before"></div><div class="arrow-after"></div></div>';ctn+="</div>";n=a(ctn);if(c.width!=""){a(n).css("width",c.width)}if(o.charAt(0)=="i"){a(n).css("width","auto")}a.data(this,"active.tipsy",n)}n.find(".tipsy-inner")[c.html?"html":"text"](c.fallback);if(c.title!="title"){n.find(".tipsy-title")[c.html?"html":"text"](c.title)}var j=a.extend({},a(this).offset(),{width:this.offsetWidth,height:this.offsetHeight});n.get(0).className="tipsy";n.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var f=n[0].offsetWidth,h=n[0].offsetHeight;var k=a(window).scrollLeft();var i=a(window).scrollTop();var g=k+a(window).width();var e=i+a(window).height();var m=j.top+h+25;var d=j.left+f+30;var l=o.charAt(0);switch(l){case"n":n.find(".tipsy-arrow").addClass("tipsy-arrow-down");n.find(".tipsy-arrow").removeClass("tipsy-arrow-up");n.css({top:j.top-h,left:j.left+j.width/2-20});break;case"s":n.find(".tipsy-arrow").addClass("tipsy-arrow-up");n.find(".tipsy-arrow").removeClass("tipsy-arrow-down");n.css({top:j.top+j.height+10,left:j.left+j.width/2-20});break;case"e":n.find("img").each(function(p){n.find(".tipsy-inner")[c.html?"html":"text"]('<img src="media/loading.gif"> Loading ...');n.find(".tipsy-arrow").css("display","none");f=80;a(this).bind("load",function(){f=this.width+20;n.css({top:j.top,left:j.left-f-10});n.find(".tipsy-arrow").css("display","");n.find(".tipsy-inner")[c.html?"html":"text"](c.fallback)}).attr("src",a(this).attr("src"))});n.find(".tipsy-arrow").addClass("tipsy-arrow-right");n.css({top:j.top,left:j.left-f-10});console.log("Go here right");break;case"w":n.find("img").each(function(p){n.find(".tipsy-inner")[c.html?"html":"text"]('<img src="media/loading.gif"> Loading ...');n.find(".tipsy-arrow").css("display","none");f=80;a(this).bind("load",function(){f=this.width+20;n.css({top:j.top,left:j.left+j.width+10});n.find(".tipsy-arrow").css("display","");n.find(".tipsy-inner")[c.html?"html":"text"](c.fallback)}).attr("src",a(this).attr("src"))});n.css({top:j.top,left:j.left+j.width+10});break}if(l=="n"||l=="s"){if(m>=e){n.find(".tipsy-arrow").addClass("tipsy-arrow-down");n.find(".tipsy-arrow").removeClass("tipsy-arrow-up");n.css("top",j.top-h);console.log("Go here 2")}if(d>=g){n.css("left",j.left-f+30);n.find(".tipsy-arrow").css("left",f-30)}}if(c.fade){n.css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:0.8})}else{n.css({visibility:"visible"})}},function(){a.data(this,"cancel.tipsy",false);var d=this;setTimeout(function(){if(a.data(this,"cancel.tipsy")){return}var e=a.data(d,"active.tipsy");if(c.fade){e.stop().fadeOut(function(){a(this).remove()})}else{e.remove()}},100)})})};a.fn.tipsy.defaults={fade:false,fallback:"",gravity:"n",html:true,title:"title"};a.fn.tipsy.elementOptions=function(c,b){return a.metadata?a.extend({},b,a(c).metadata()):b}})(jQuery);(function(a){a.fn.tiptip=function(b){b=a.extend({},a.fn.tiptip.defaults,b);return this.each(function(){var c=a.fn.tiptip.elementOptions(this,b);a(this).click(function(){a.data(this,"cancel.tiptip",true);var m=a.data(this,"active.tiptip");var o=(typeof c.gravity=="function")?c.gravity.call(this):c.gravity;if(!m){ctn='<div class="tiptip">';if(c.title!="title"){ctn+='<div class="tiptip-title">Help</div>'}ctn+='<div class="tiptip-inner"/>';btn_close='<span class="box_btn_close">x</span>';footer_close='<span class="btn-close">Close</span>';ctn+='<div class="tiptip-footer">'+footer_close+"</div>";ctn+=btn_close+"</div>";m=a(ctn);if(c.autowidth){if(c.fallback.length>=400&&c.fallback.length<=500){c.width=500}if(c.fallback.length<400){c.width=00}}if(c.width!=""){a(m).css("width",c.width)}if(o.charAt(0)=="i"){a(m).css("width","auto")}a.data(this,"active.tiptip",m)}m.find(".tiptip-inner")[c.html?"html":"text"](c.fallback);if(c.title!="title"){m.find(".tiptip-title")[c.html?"html":"text"](c.title)}var l=a.extend({},a(this).offset(),{width:this.offsetWidth,height:this.offsetHeight});m.get(0).className="tiptip";m.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var e=m[0].offsetWidth,h=m[0].offsetHeight;m.find(".box_btn_close").click(function(){m.remove()});m.find(".btn-close").click(function(){m.remove()});a(document).click(function(q){var p=(q)?q:event;var r=(p.srcElement)?p.srcElement:p.target;console.log("Go here: "+q.target.className);if(m.has(q.target).length===0&&r!="javascript:void(0)"&&q.target.className!="tiptip"){a(".tiptip").remove()}});var k=a(window).scrollTop();var d=k+a(window).height();var n=l.top+h+25;var f=Math.round(l.top);switch(o.charAt(0)){case"n":var j=f-h;if(j<10){j=10}var g=l.left-e+this.offsetWidth;m.find(".tipsy-arrow").css("display","none");m.css({top:j,left:g});if((f-(h))<k){if(n>=d){var i=n-d;m.css("top",f-h-i)}else{m.css("top",f)}}break;case"s":m.find(".tipsy-arrow").css("display","none");var j=f+this.offsetHeight;var g=l.left-e+this.offsetWidth;m.css({top:j,left:g});if(n>=d&&f>h){if((f-(h))<k){var i=k-(f-(h));if(f>i){m.css("top",f-i)}}else{m.css("top",f-h)}}break;case"e":m.css({top:l.top+l.height-35,left:l.left-e-10});break;case"w":m.css({top:l.top+35,left:l.left+l.width/2-20});break;case"c":m.css({top:l.top+35,left:l.left+l.width/2-20});break;case"i":m.css({top:l.top+l.height-35,left:l.left-e-10});break}if(c.fade){m.css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:0.8})}else{m.css({visibility:"visible"})}},function(){})})};a.fn.tiptip.elementOptions=function(c,b){return a.metadata?a.extend({},b,a(c).metadata()):b};a.fn.tiptip.defaults={fade:false,fallback:"",gravity:"n",html:true,title:"title",autowidth:false}})(jQuery);function setAutocomplete(){$("#destinations").bind("keydown",function(a){if(a.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active){a.preventDefault()}}).autocomplete({minLength:1,autoFocus:true,source:function(d,e){var c=$.ui.autocomplete.escapeRegex(d.term);var f=new RegExp("^"+c,"i");var b=$.grep(GLOBALS[0],function(g,a){return f.test(g[1])});e(b)},focus:function(){return false},select:function(a,b){$("#destinations").val(b.item[1]);return false}}).data("autocomplete")._renderItem=(function(a,b){t="<span style='*float:left; *width:60%'>"+b[1]+"</span>";t=t+"<span style='float:right;*float:left; *width:32%;*display:inline;*text-align: right;'>"+getRegion(b[2],b[3])+"</span>";return $("<li></li>").data("item.autocomplete",b).append("<a>"+t+"</a>").appendTo(a)});$("#destinations").autocomplete("widget").removeClass("ui-corner-all")}function initSearchBox(){if($("#destinations").val()==$("#destinations").attr("alt")){$("#destinations").css("color","#808080");$("#destinations").css("font-style","italic")}}function get_des_selected_ids(){if($("#destinations").val()==""||$("#destinations").val()==$("#destinations").attr("alt")){return null}var d=$("#destinations").val();d=$.trim(d);var e=new Array();var b=GLOBALS[0];var a=0;for(var c=0;c<b.length;++c){if(d!=""&&b[c][1]!=""&&$.trim(b[c][1])==d){e[a]=b[c][0];a++}}return e}function searchfield_focus(a){if(a.value==$(a).attr("alt")){a.value="";a.style.color="";a.style.fontStyle=""}}function searchfield_blur(a){if(a.value==""){a.value=$(a).attr("alt");a.style.color="#808080";a.style.fontStyle="italic"}}function split(a){return a.split(/,\s*/)}function extractLast(a){return split(a).pop()}function check_travel_date(a,g){var f=new Date();var e=a.split("-");var c=new Date(f.getFullYear(),f.getMonth(),f.getDate());var b=new Date(parseInt(e[2],10),[parseInt(e[1],10)-1],parseInt(e[0],10));if(b<=c){alert(g)}}function getSearchParams(){var c="destination="+$("#destinations").val()+"&departure_date="+$("#departure_date").val();var a=getSelectedTravelStyles();if(a!=""){c=c+"&travel_styles="+a}c=c+"&duration="+$("#duration option:selected").text();var b=getSelectedClassServices();if(b!=""){c=c+"&class_sv="+b}if($("#tour_type").attr("checked")){c=c+"&tour_type=private"}return c}function getSelectedClassServices(){var a="";$("input[name^='class_service']:checked").each(function(b){a=a+$(this).attr("alt")+":"});if(a!=""){a=a.substring(0,a.length-1)}return a}var disabledDays="";function initDate(m,e,k,o,d,h,i,f){if(h==undefined){h=""}if(i==undefined){i=""}if(f==undefined){f=""}var j=e.split("-");var c="";if(f!=""&&typeof(j[1])!="undefined"){var g=parseInt(j[0],10);var l=parseInt(j[1],10);var n=parseInt(j[2],10);if(!checkDate(g,l,n,f)){c=getNearDepartureDate(g,l,n,f);if(c==""){c=m}e=c}}initOptionMonth(m,e,o,f);initOptionDay(e,k,f);if(f!=""&&c==m){var b=$(k+" option:first").val();var a=$(o+" option:first").val();if(typeof(b)!="undefined"&&typeof(a)!="undefined"){e=b+"-"+a}}$(d).val(e);if(typeof(f)!="undefined"&&f!=""){disabledDays=f}$(d).datepicker({showOn:"button",dateFormat:"dd-mm-yy",buttonImage:"/media/calendar.gif",buttonImageOnly:true,duration:"",buttonText:"Pick a date to check rates",onSelect:function(q,p){selectDate(q,k,o,f);getDepartureDay(q,h,i);$(k).change()},beforeShowDay:function(p){if(typeof(f)!="undefined"&&f!=""){sDate=p.getDate();sMonth=p.getMonth()+1;if(checkDate(sDate,sMonth,p.getFullYear(),disabledDays)){return[true,""]}else{return[false,"","Unavailable"]}}return[true,""]}});getDepartureDay(e,h,i)}function getNearDepartureDate(v,w,f,u){var n="";var h=new Date([w,v,f].join("/"));var d=[];var c=[];var a=[];var r=0;for(var s=0;s<u.length;++s){var e=u[s][0];var g=u[s][1];for(var q=0;q<g.length;++q){var m=u[s][1][q].date;m=m.split(",");for(var o=0;o<m.length;++o){var p=[g[q].month,m[o],e].join("/");thisDate=new Date(p),curDiff=h-thisDate;a.push([r,thisDate]);curDiff<0?d.push([r,curDiff]):c.push([r,curDiff]);r++}}}d.sort(function(j,i){return j[1]<i[1]});c.sort(function(j,i){return j[1]>i[1]});if(typeof(d[0])!="undefined"){var x=a[d[0][0]][1].getDate();var l=a[d[0][0]][1].getMonth()+1;var b=a[d[0][0]][1].getFullYear();n=x+"-"+l+"-"+b}else{if(typeof(c[0])!="undefined"){var x=a[c[0][0]][1].getDate();var l=a[c[0][0]][1].getMonth()+1;var b=a[c[0][0]][1].getFullYear();n=x+"-"+l+"-"+b}}return n}function selectDate(e,b,d,a){var c=e.split("-");$.each($(d).attr("options"),function(f,g){optarr=g.value.split("-");if(parseInt(c[1],10)==parseInt(optarr[0],10)&&parseInt(c[2],10)==parseInt(optarr[1],10)){g.selected=true;initOptionDay(e,b,a);return}})}function initOptionMonth(m,d,o,e){var g="";var f=m.split("-");var n=d.split("-");var c=getMonthsAndYears(f[1],f[2],e);var b=n[1];var l=n[2];for(var h=0;h<c.length;++h){var j=c[h].split("-");var k=j[1];var a=j[0];if(typeof(e)!="undefined"&&e!=""){if(!checkMonth(a,k,e)){continue}}if(parseInt(b,10)==parseInt(a,10)&&l==k){g+='<option value="'+c[h]+'" selected="selected" >'+month_names[a-1]+", "+k+"</option>"}else{g+='<option value="'+c[h]+'">'+month_names[a-1]+", "+k+"</option>"}}$(o).html(g)}function initOptionDay(c,f,d){var g="";var h=c.split("-");var j=daysInMonth(h[1],h[2]);for(var e=0;e<j.length;++e){if(typeof(d)!="undefined"&&d!=""){var b=j[e].split("-");if(!checkDate(b[1],parseInt(h[1],10),h[2],d)){continue}}var a=j[e].split("-");if(parseInt(a[1],10)==parseInt(h[0],10)){g+='<option value="'+a[1]+'" selected>'+a[0]+", "+a[1]+"</option>"}else{g+='<option value="'+a[1]+'">'+a[0]+", "+a[1]+"</option>"}}$(f).html(g)}function changeMonth(g,k,c,e,f,d){var a=$(k).attr("options");var j=$(g).attr("options");var i=a[a.selectedIndex].value.split("-");if(typeof j[j.selectedIndex]!="undefined"){if(j.selectedIndex>-1){var b=j[j.selectedIndex].value;var h=b+"-"+i[0]+"-"+i[1];initOptionDay(h,g,d);changeDay(g,k,c,e,f)}}}function changeDay(f,i,c,d,e){var a=$(i).attr("options");var h=$(f).attr("options");var b=h[h.selectedIndex].value;var g=a[a.selectedIndex].value.split("-");$(c).val(b+"-"+g[0]+"-"+g[1]);getDepartureDay(b+"-"+g[0]+"-"+g[1],d,e)}function changeNight(d,b,c){var a=$(b).val();getDepartureDay(a,d,c)}function show_sortlist(){$("#sortlist").show()}function hide_sortlist(){$("#sortlist").hide()}var month_names=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var daysofweek=["Sun","Mon","Tue","Wed","Thur","Fri","Sat"];var LIMIT_MONTH=12;var FAVOURITE_TOURS="favourite_tours";var MY_VIEWED_HOTELS="my_viewed_hotels";var MY_VIEWED_CRUISES="my_viewed_cruises";function getDepartureDay(c,e,d){if(e==undefined||e==""){}else{var b="";b=parseInt($(e).val());var a=c.split("-");var g=new Date(parseInt(a[2],10),parseInt(a[1],10)-1,parseInt(a[0],10));g.setDate(g.getDate()+b);var f=month_names[g.getMonth()]+" "+g.getFullYear();f=daysofweek[g.getDay()]+" "+g.getDate()+" "+f;$(d).text(f)}}function getMonthsAndYears(d,c,b){d=parseInt(d,10);c=parseInt(c,10);if(b!=""){LIMIT_MONTH=18}var a=new Array();t_nextmonth=new Date(c,d-1,1);for(var e=0;e<LIMIT_MONTH;++e){n_month=t_nextmonth.getMonth()+1;n_year=t_nextmonth.getFullYear();a.push(n_month+"-"+n_year);t_nextmonth.setMonth(n_month)}return a}function daysInMonth(e,c){e=parseInt(e,10);c=parseInt(c,10);var d=new Array();var a=32-new Date(c,e-1,32).getDate();for(var b=1;b<=a;++b){day=new Date(c,e-1,b);d.push(daysofweek[day.getDay()]+"-"+b)}return d}function getRegion(b,a){if(a!=null&&a!=""){return a}return""}if(!Array.indexOf){Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){return a}}return -1}}if(!String.replaceAll){String.prototype.replaceAll=function(d,c){var a=this;var b=a.indexOf(d);while(b!=-1){a=a.replace(d,c);b=a.indexOf(d)}return a}}function unique(a){tmpArr=new Array(0);for(var b=0;b<a.length;b++){if(a[b]!=""&&tmpArr.indexOf(a[b])==-1){tmpArr.length+=1;tmpArr[tmpArr.length-1]=a[b]}}return tmpArr}function checkDate(c,h,k,d){var a=false;for(var f=0;f<d.length;++f){if(typeof(d[f])=="undefined"||d==""){continue}if(k==d[f][0]){var g=get_index_of_month(d[f][1],h);if(g>-1){var b=d[f][1][g].date;b=b.split(",");for(var e=0;e<b.length;++e){if(parseInt(c,10)==parseInt(b[e],10)){a=true}}}}}return a}function get_index_of_month(a,c){for(var b=0;b<a.length;++b){if(parseInt(a[b].month)==parseInt(c)){return b}}return -1}function getMonthsAndYearsCheckRates(c,b){c=parseInt(c,10);b=parseInt(b,10);var a=new Array();t_nextmonth=new Date(b,c-1,1);for(var d=0;d<LIMIT_MONTH;++d){n_month=t_nextmonth.getMonth()+1;n_year=t_nextmonth.getFullYear();a.push(n_month+"-"+n_year);t_nextmonth.setMonth(n_month)}return a}function checkMonth(d,c,a){for(var b=0;b<a.length;++b){if(typeof(a[b])=="undefined"){continue}if(c==a[b][0]){if(get_index_of_month(a[b][1],d)>-1){return true}}}return false}function getTomorrow(){var d=new Date();var e=d.getDate();var c=d.getMonth();var a=d.getFullYear();var b=new Date(a,c,e+1);return b}function checkRoomTypeBooking(b){var a=false;$(".room_select_"+b).each(function(){var c=$(this).find("option:selected").val();if(c>0){a=true}});return a}function openRoomTypeInfo(b){var a=$("#img_"+b).attr("class");if(a=="togglelink"){$("#img_"+b).removeClass("togglelink");$("#img_"+b).addClass("togglelink_open");$("#detail_infor_"+b).show()}else{$("#img_"+b).removeClass("togglelink_open");$("#img_"+b).toggleClass("togglelink");$("#detail_infor_"+b).hide()}return false}function openExtrabedInfo(b){var a=$("#img_extra_"+b).attr("class");if(a=="togglelink"){$("#img_extra_"+b).removeClass("togglelink");$("#img_extra_"+b).addClass("togglelink_open");$("#extra_bed_"+b+"_select").show()}else{$("#img_extra_"+b).removeClass("togglelink_open");$("#img_extra_"+b).toggleClass("togglelink");$("#extra_bed_"+b+"_select").hide()}return false}function show_hotel_detail(b,c){var a="/hotel_detail/detail/"+b;window.open(a,"_blank",c)}function addDays(a,b){return new Date(a.getTime()+b*24*60*60*1000)}function re_arrange_cabin(a){$("#re_arrange_cabin_"+a).show();$("#re_arrange_cabin_text_"+a).hide();$("#re_arrange_cabin_guide_"+a).hide()}function hide_re_arrange_cabin(a){$("#re_arrange_cabin_"+a).hide();$("#re_arrange_cabin_text_"+a).show();$("#re_arrange_cabin_guide_"+a).show()}function change_cabin(a,b){var e=$("#num_cabin_"+a+" option:selected").val();for(var d=1;d<=b;d++){var c="#"+a+"_cabin_"+d;if(d<=e){$(c).show()}else{$(c).hide()}}object_change_info("change_cabin",a)}function check_error_check_rates(g){var c=false;var h=$("#object_change_"+g).val();if(h=="change_cabin"){var f=$("#num_cabin_"+g+" option:selected").val();for(var b=1;b<=f;b++){var d=parseInt($("#"+g+"_type_"+b+" option:selected").val());var e=parseInt($("#"+g+"_adults_"+b+" option:selected").val());var a=parseInt($("#"+g+"_children_"+b+" option:selected").val());var j=parseInt($("#"+g+"_infants_"+b+" option:selected").val());if(e+a+j>3){$("#"+g+"_errors_"+b).show();$("#"+g+"_errors_"+b+"_1").show();$("#"+g+"_errors_"+b+"_2").hide();$("#"+g+"_errors_"+b+"_3").hide();c=true}else{if(e+a==0){$("#"+g+"_errors_"+b).show();$("#"+g+"_errors_"+b+"_2").show();$("#"+g+"_errors_"+b+"_1").hide();$("#"+g+"_errors_"+b+"_3").hide();c=true}else{if(e+a!=1&&d==3){$("#"+g+"_errors_"+b).show();$("#"+g+"_errors_"+b+"_3").show();$("#"+g+"_errors_"+b+"_1").hide();$("#"+g+"_errors_"+b+"_2").hide();c=true}}}}}return c}function object_change_info(g,a){$("#object_change_"+a).val(g);var e=$("#object_change_"+a).val();if(e=="change_cabin"){var f=$("#num_cabin_"+a+" option:selected").val();var b=0;var d=0;var h=0;for(var c=1;c<=f;c++){b=b+parseInt($("#"+a+"_adults_"+c+" option:selected").val());d=d+parseInt($("#"+a+"_children_"+c+" option:selected").val());h=h+parseInt($("#"+a+"_infants_"+c+" option:selected").val())}$("#adults_"+a+" option[value="+b+"]").attr("selected","selected");$("#children_"+a+" option[value="+d+"]").attr("selected","selected");$("#infants_"+a+" option[value="+h+"]").attr("selected","selected")}}function get_end_date_of_tour(k,r,j,g,a,o){var f=$(k).val();var m=$(r).val();if(f!=""&&f!=null&&m!=""&&m!=null){m=m.split("-");var d=parseInt($.trim(m[1]));var q=parseInt($.trim(m[0]))-1;var n=parseInt($.trim(f));var l=new Date(d,q,n);l.setDate(l.getDate()+g);var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var e=l.getDate()+" "+c[l.getMonth()]+", "+l.getFullYear();var p="";if(typeof(a)!="undefined"&&a!=""){for(var h=0;h<a.length;++h){var b=n+"-"+(q+1)+"-"+d;if(b==a[h]){p=" (Upstream)"}}}if(typeof(o)!="undefined"&&o){for(var h=0;h<o.length;++h){var b=n+"-"+(q+1)+"-"+d;if(b==o[h]){p=" (Downstream)"}}}e=e+p;$(j).html(e)}}function show_tour_detail(b,c){var a="/tour_detail/detail/"+b+".html";window.open(a,"_blank",c)}function show_accomm_detail(c){var b="accomm_detail_"+c;var a=$("#img_"+c).attr("class");if(a=="togglelink"){$("#img_"+c).removeClass("togglelink");$("#img_"+c).addClass("togglelink_open");$("#accomm_detail_"+c).show()}else{$("#img_"+c).removeClass("togglelink_open");$("#img_"+c).toggleClass("togglelink");$("#accomm_detail_"+c).hide()}return false}function setAjaxAutocomplete(a,b){$("#destination_ajax_"+a).bind("keydown",function(c){if(c.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active){c.preventDefault()}}).autocomplete({minLength:1,autoFocus:true,source:function(e,f){var d=$.ui.autocomplete.escapeRegex(e.term);var g=new RegExp("^"+d,"i");var c=$.grep(b,function(i,h){if(a.toLowerCase().indexOf("hotel")>=0){return g.test(i.name)}else{return g.test(i[1])}});f(c)},focus:function(){return false},select:function(c,d){if(a.toLowerCase().indexOf("hotel")>=0){$("#destination_ajax_"+a).val(d.item.name)}else{$("#destination_ajax_"+a).val(d.item[1])}return false}}).data("autocomplete")._renderItem=(function(d,f){var c;var g;var e;if(a.toLowerCase().indexOf("hotel")>=0){c=f.name;g=f.region;e=f.parent}else{c=f[1];g=f[2];e=f[3]}t="<span style='*float:left; *width:60%'>"+c+"</span>";t=t+"<span style='float:right;*float:left; *width:40%;*display:inline;*text-align: right;'>"+getRegion(g,e)+"</span>";return $("<li></li>").data("item.autocomplete",f).append("<a>"+t+"</a>").appendTo(d)});$("#destination_ajax_"+a).autocomplete("widget").removeClass("ui-corner-all")}function getSelectedTourAjax(d){var c=$("#destination_ajax_"+d).val();c=$.trim(c);var a=GLOBALS[0];for(var b=0;b<a.length;++b){if(a[b][1]==c){return a[b][0]}}return null}function getSelectedHotelAjax(b){if($("#destination_ajax_"+b).val()==""){return null}for(var a=0;a<destinations.length;a++){if(destinations[a].name==$("#destination_ajax_"+b).val()){if(destinations[a].object_type==1){return destinations[a].name}else{return destinations[a].id}}}}function show_block(d,c){var e="#block_search_content_"+c;var b="#show_more_"+c;var a=$(d).attr("class");if(a=="hide"){$(d).removeClass("hide");$(d).addClass("show");$(e).show();$(b).show()}else{$(d).removeClass("show");$(d).addClass("hide");$(e).hide();$(b).hide()}}function show_cruise_detail(b,c){var a="/cruise_detail/detail/"+b;window.open(a,"_blank",c)}function getPriceNumber(a){a=a.replace("$","");a=$.trim(a);return getFormatNumber(a)}function getFormatNumber(a){a=a.replace(",","");return Number(a)}function show_booking(c){var a="#"+c+"_img_booking";var b="#"+c+"_booking_content";var d="#"+c+"_booking_total";var e=$(a).attr("src");if(e=="/media/btn_mini.gif"){e="/media/btn_mini_hover.gif";$(a).attr("src",e);$(b).show();$(d).hide()}else{e="/media/btn_mini.gif";$(a).attr("src",e);$(b).hide();$(d).show()}}var clockID=0;function getTimeLeft(){var d=$("#timeLeft").html();d=d.split(":");var c=$.trim(d[2]);var a=$.trim(d[1]);var b=$.trim(d[0]);c--;if(c<0){c=(c+60)%60;a--}if(a<0){a=(a+60)%60;b--}if(b<0){b=(b+24)%24}if(clockID){clearTimeout(clockID);clockID=0}d=" "+b+":"+a+":"+c;$("#timeLeft").html(d);clockID=setTimeout("getTimeLeft()",1000)}function initSearchForm(a,b){if($('input:radio[name="search_type"]')[0]){$('input:radio[name="search_type"]')[0].checked=true}initSearchBox();initDate(a,b,"#departure_day","#departure_month","#departure_date");setAutocomplete();$("#search_help").tipsy({fallback:$("#search_help_content").val(),gravity:"s",width:"auto",title:"Help"});$("#tour_type_help").tipsy({fallback:$("#tour_type_help_content").val(),gravity:"s",width:"auto",title:"Help"});$("#destination_help").tipsy({fallback:$("#destination_help_content").val(),gravity:"s",width:"auto",title:"Help"});$("#travel_style_help").tipsy({fallback:$("#travel_style_help_content").val(),gravity:"s",width:"auto",title:"Help"})}function change_search_type(d,a,b){var c=$(d).val();if(c==2){$("#frmSearchForm").css("display","none");$("#block_hotel_search_form").css("display","block");$("#search_help").tipsy({fallback:$("#hotel_help").val(),gravity:"s"})}else{$("#block_hotel_search_form").css("display","none");$("#frmSearchForm").css("display","block");if($("#destinations").val()==$("#destinations").attr("alt")){$("#destinations").css("color","#808080");$("#destinations").css("font-style","italic")}initSearchForm(a,b)}}function search(d,c){var a=true;var b=get_des_selected_ids();if(b!=null&&b.length>0){$("#destination_ids").val(b);$("#is_cruise_port").val("")}else{alert("Your destinations you entered not found! Please select in drop-down list.");a=false;return false}if(a){check_travel_date($("#departure_date").val(),d);document.frmSearchForm.action=c+getSearchParams();document.frmSearchForm.submit()}}function getSelectedTravelStyles(){var b="";for(var a=0;a<GLOBAL_TRAVEL_STYLE.length;++a){if($("#travelstyle_"+a).attr("checked")){b=b+GLOBAL_TRAVEL_STYLE[a].name+":"}}if(b!=""){b=b.substring(0,b.length-1)}return b}function click_book_together(b,a,c){window.location.href="/book-together/"+b+"/"+a+"/"+c+"/"}function back_to_top(){$("html, body").animate({scrollTop:0},"fast")}function go_bottom(){$("html, body").animate({scrollTop:$(document).height()-$(window).height()},"slow")}function go_book_together_position(){$("html, body").animate({scrollTop:$("#booking_together_section").offset().top},"fast")}function show_service(e,b){var c="#"+e+"_img_collapse";var d=$(c).attr("src");if(d=="/media/btn_mini.gif"){d="/media/btn_mini_hover.gif";$(c).attr("src",d);$("div#"+e).show();var a=$("div#"+e).attr("load");if(a!="loaded"){$.ajax({url:b,type:"POST",data:"",success:function(f){$("div#"+e).html(f);$("div#"+e).attr("load","loaded")}})}$("#"+e+"_button_book").hide();$(".plus_icon_"+e).show()}else{d="/media/btn_mini.gif";$(c).attr("src",d);$("div#"+e).hide();$("#"+e+"_button_book").show()}}function search_more(f,b,c,a){if(c!=undefined){if(a=="hotel"){var e=getSelectedHotelAjax(f)}else{var e=getSelectedTourAjax(f)}if(e==null||e==""){alert("Your destinations you entered not found! Please select in drop-down list.");$("#destination_ajax_"+f).focus();return false}else{$("#destination_id_"+f).val(e)}}if(b==undefined||b==""){b=$("#form_"+f).attr("action")}var d=$("#form_"+f).serialize();var g="#block_search_content_"+f;$("html, body").animate({scrollTop:$("#block_recommendation_"+f).offset().top},"fast");if($("#block_search_result_"+f).length>0){showIndicator("#block_search_result_"+f)}else{showIndicator(g)}$.ajax({url:b,type:"POST",data:d,success:function(h){$(g).html(h)}});$("#show_more_"+f).css("display","none")}function showIndicator(b){var a="/media/loading-indicator.gif";$(b).html('<div style="width:100%;text-align:center;"><img src="'+a+'"/></div>')}function bt_sort_by(c,b,a){$("#sort_by_"+c).val(b);search_more(c,"","1",a)}function go_check_rate_position(){$("html, body").animate({scrollTop:$("#tabs").offset().top},"fast")}function go_url(a){window.location.href=a}function close_popup(){$("#overlay_popup").hide();$("#popup_container").hide();$("#popup_content").html("")}function see_cruise_overview(a,d,b){var e=getCookie("departure_date");if(e==null||e==""){}else{d=e}if(b==null||b==undefined){b=""}$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var c=$(document).scrollTop()+60;$("#popup_container").css("top",c);$("#overlay_popup").show();$("#popup_container").show();$.ajax({url:"/cruise_detail/see_overview/",type:"POST",cache:true,data:{cruise_id:a,departure_date:d,cruise_name:b},success:function(f){$("#popup_content").html(f)}})}function see_more_deals(a,c){$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var b=$(document).scrollTop()+80;$("#popup_container").css("top",b);$("#overlay_popup").show();$("#popup_container").show();$.ajax({url:"/tour_search/see_more_deals/",type:"POST",cache:true,data:{tour_id:a,departure_date:c},success:function(d){$("#popup_content").html(d)}})}function see_tour_overview(b,d,a){var e=getCookie("departure_date");if(e==null||e==""){}else{d=e}if(a==null||a==undefined){a=""}$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var c=$(document).scrollTop()+60;$("#popup_container").css("top",c);$("#overlay_popup").show();$("#popup_container").show();$.ajax({url:"/tour_search/see_overview/",type:"POST",cache:true,data:{tour_id:b,departure_date:d,tour_name:a},success:function(f){$("#popup_content").html(f)}})}function see_hotel_overview(d,a,c){var e=getCookie("arrival_date");if(e==null||e==""){}else{a=e}if(c==null||c==undefined){c=""}$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var b=$(document).scrollTop()+60;$("#popup_container").css("top",b);$("#overlay_popup").show();$("#popup_container").show();$.ajax({url:"/hotel_detail/see_overview/",type:"POST",cache:true,data:{hotel_id:d,arrival_date:a,hotel_name:c},success:function(f){$("#popup_content").html(f)}})}function see_destination_overview(d,c,b){var e=getCookie("departure_date");if(e==null||e==""){}else{c=e}if(b==null||b==undefined){b=""}$("#popup_content").html('<center><img alt="" src="http://www.bestpricevn.net/media/loading-indicator.gif"></center>');var a=$(document).scrollTop()+60;$("#popup_container").css("top",a);$("#overlay_popup").show();$("#popup_container").show();$.ajax({url:"/destination/see_overview/",type:"POST",cache:true,data:{destination_id:d,destination_name:b,departure_date:c},success:function(f){$("#popup_content").html(f)}})}function show_hide_img(b){var a=$(b).attr("stat");if(a=="hide"){$(".img_hide").show();$(b).attr("stat","show");$(b).html("Show less &laquo;")}else{$(".img_hide").hide();$(b).attr("stat","hide");$(b).html("Show more &raquo;")}}function getCookie(b){var c=document.cookie;var d=c.indexOf(" "+b+"=");if(d==-1){d=c.indexOf(b+"=")}if(d==-1){c=null}else{d=c.indexOf("=",d)+1;var a=c.indexOf(";",d);if(a==-1){a=c.length}c=unescape(c.substring(d,a))}return c};